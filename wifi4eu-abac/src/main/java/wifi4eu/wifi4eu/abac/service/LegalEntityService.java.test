package wifi4eu.wifi4eu.abac.service;

import java.io.File;
import java.nio.file.Files;

import javax.swing.JFileChooser;
import javax.swing.filechooser.FileNameExtensionFilter;

import org.slf4j.Logger;
import org.slf4j.LoggerFactory;
import org.springframework.stereotype.Service;
import org.springframework.transaction.annotation.Transactional;

import wifi4eu.wifi4eu.common.dto.rest.ResponseDTO;

@Service
public class LegalEntityService {

	private final Logger log = LoggerFactory.getLogger(LegalEntityService.class);

	@Transactional
	public boolean importLegalEntity() throws Exception {
		log.info("importLegalEntity");
		JFileChooser fc = new JFileChooser();
		fc.setAcceptAllFileFilterUsed(false);

		// Receive CSV file
		FileNameExtensionFilter filter = new FileNameExtensionFilter("CSV Files (*.csv)", "csv");

		fc.setFileFilter(filter);
		int response = fc.showOpenDialog(null);
		if (response == JFileChooser.APPROVE_OPTION) {
			File file = fc.getSelectedFile();
			String content = new String(Files.readAllBytes(file.toPath()));

			// TODO Javi
			// do stuff

			return true;
		}
		return false;
	}

	public ResponseDTO exportLegalEntity() throws Exception {
		log.info("exportLegalEntity");
		ResponseDTO result = new ResponseDTO();

		// TODO Javi
		// do stuff
		String data = "id,mun_OfficialName,mun_OfficialAddress,reg_RegistartionNumber\r\n"
				+ "1,Barcelona,C\\\\Aragón,6\r\n" + "2,Barcelona,C\\\\Aragón,7\r\n"
				+ "3,Madrid,C\\\\Bravo Murillo,8\r\n" + "4,Bruxelles,Rue Montoyer,9";
		result.setData(data);

		result.setError(null);
		return result;
	}

}
